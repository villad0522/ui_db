<!DOCTYPE html>
<html lang="ja">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>ビューの編集</title>
        <!--  -->
        <!-- bootstrap5.3を読み込む -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
        <!-- bootstrapのドキュメントはこちら -->
        <!-- https://getbootstrap.jp/docs/5.3/getting-started/introduction/ -->
        <!--  -->
        <!--  -->
        <!-- bootstrapのアイコンを読み込む -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <!--  -->
        <!-- 自作CSSを読み込む -->
        <link rel="stylesheet" href="./style.css" type="text/css">
        <link rel="stylesheet" href="../auto_correct.css" type="text/css">
        <!--  -->
        <!-- 自作JavaScriptを読み込む -->
        <script src="./script.js" type="module"></script>
    </head>

    <body style="visibility: hidden;">
        <form>
            <div class="container">
                <div style="text-align: right;">
                    <small style="font-size: 12px; color: #aaa; margin-right: 20px;">
                        ビューID : <span name="viewId"></span>
                    </small>
                    <button onclick="myFetch('./update_view/form')" type="button" class="btn btn-primary">
                        保存
                    </button>
                    <button onclick="handleDeleteView()" type="button" class="btn btn-outline-danger">
                        ビューを削除
                    </button>
                </div>
                <br>
                <br>
                <div class="row">
                    <div class="col-12 col-md-6 col-lg-4 mb-3">
                        <label for="viewName" class="form-label">
                            ビューの名前
                        </label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="viewName" name="viewName">
                        </div>
                    </div>
                    <div class="col-12 col-md-6 col-lg-4 mb-3">
                        <label for="viewType" class="form-label">
                            画面の表示形式
                        </label>
                        <select name="viewType" id="viewType" class="form-select">
                            <option value="TABLE">表</option>
                            <option value="BUTTON">ボタン</option>
                            <option value="CARD">カード</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-6 col-lg-4 mb-3" name="isExcel_flag">
                        <label for="sheetName" class="form-label">
                            Excelファイルに書き出す際のシート名
                        </label>
                        <input type="text" class="form-control" id="sheetName" name="sheetName">
                    </div>
                    <div class="col-12 col-md-6 col-lg-4 mb-3" name="isExcel_flag">
                        <label class="form-label">
                            Excelの開始位置
                        </label>
                        <div class="input-group">
                            <span class="input-group-text">列</span>
                            <select onchange="myFetch('./update_view/form')" class="form-select" name="excelStartColumn">
                                <option selected value="1">A</option>
                                <option value="2">B</option>
                                <option value="3">C</option>
                                <option value="4">D</option>
                                <option value="5">E</option>
                                <option value="6">F</option>
                                <option value="7">G</option>
                                <option value="8">H</option>
                                <option value="9">I</option>
                                <option value="10">J</option>
                                <option value="11">K</option>
                                <option value="12">L</option>
                                <option value="13">M</option>
                                <option value="14">N</option>
                                <option value="15">O</option>
                                <option value="16">P</option>
                                <option value="17">Q</option>
                                <option value="18">R</option>
                                <option value="19">S</option>
                                <option value="20">T</option>
                                <option value="21">U</option>
                                <option value="22">V</option>
                                <option value="23">W</option>
                                <option value="24">X</option>
                                <option value="25">Y</option>
                                <option value="26">Z</option>
                                <option value="27">AA</option>
                                <option value="28">AB</option>
                                <option value="29">AC</option>
                                <option value="30">AD</option>
                                <option value="31">AE</option>
                                <option value="32">AF</option>
                                <option value="33">AG</option>
                                <option value="34">AH</option>
                                <option value="35">AI</option>
                                <option value="36">AJ</option>
                                <option value="37">AK</option>
                                <option value="38">AL</option>
                                <option value="39">AM</option>
                                <option value="40">AN</option>
                                <option value="41">AO</option>
                                <option value="42">AP</option>
                                <option value="43">AQ</option>
                                <option value="44">AR</option>
                                <option value="45">AS</option>
                                <option value="46">AT</option>
                                <option value="47">AU</option>
                                <option value="48">AV</option>
                                <option value="49">AW</option>
                                <option value="50">AX</option>
                                <option value="51">AY</option>
                                <option value="52">AZ</option>
                            </select>
                            <span class="input-group-text">行</span>
                            <input type="number" class="form-control" name="excelStartRow">
                        </div>
                    </div>
                    <div class="col-12 col-md-6" name="isExcel_flag">
                        <br>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="isTableHeader" name="isTableHeader">
                            <label class="form-check-label" for="isTableHeader">
                                Excelファイルに書き出す際に、列名を出力する
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <br>
            <br>
            <div class="table-responsive">
                <table class="table table-bordered text-nowrap">
                    <thead>
                        <tr>
                            <script>
                                let htmlText3 = "";
                                for (let j = 0; j < 35; j++) {
                                    htmlText3 += `
                                        <td name="viewColumns${j}_flag">
                                            <div style="display: flex; justify-content: center;">
                                                <button onclick="handleToLeftViewColumn(${j})" type="button" class="btn btn-secondary btn-sm">
                                                    <i class="bi bi-arrow-left"></i>
                                                </button>
                                                <span name="viewColumns${j}_excelColumnText" style="padding: 0 10px;"></span>
                                                <button onclick="handleToRightViewColumn(${j})" type="button" class="btn btn-secondary btn-sm">
                                                    <i class="bi bi-arrow-right"></i>
                                                </button>
                                            </div>
                                        </td>
                                    `;
                                }
                                document.write(htmlText3);
                            </script>
                            <th scope="col" rowspan="2" style="border-bottom: solid; vertical-align: middle;">
                                <button class="btn btn-outline-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasExample" aria-controls="offcanvasExample">
                                    <i class="bi bi-arrow-left"></i>
                                    もっと列を表示する
                                </button>
                            </th>
                        </tr>
                        <tr>
                            <script>
                                let htmlText1 = "";
                                for (let j = 0; j < 35; j++) {
                                    htmlText1 += `
                                    <th scope="col" class="form" name="viewColumns${j}_flag" style="border-bottom: solid; padding-top: 3px;">
                                        <div class="input-group">
                                            <!--  -->
                                            <!-- 列の名前を入力するテキストボックス -->
                                            <input name="viewColumns${j}_viewColumnName" type="text" class="form-control">
                                            <!--  -->
                                            <!-- 削除ボタン -->
                                            <button onclick="handleDeleteViewColumn(${j})" type="button" class="btn btn-outline-danger btn-sm">
                                                <i class="bi bi-trash"></i>
                                            </button>
                                        </div>
                                        <input name="viewColumns${j}_viewColumnId" style="display: none;">
                                        <input name="viewColumns${j}_flag" style="display: none;" type="checkbox">
                                        <!--  -->
                                        <!-- 列の横幅を確保するために、見えない文字を表示する -->
                                        <div name="viewColumns${j}_viewColumnName" class="dummy_th"></div>
                                    </th>
                                `;
                                }
                                document.write(htmlText1);
                            </script>
                        </tr>
                    </thead>
                    <tbody style="opacity: 0.3;">
                        <script>
                            const MAX_RECORD_SIZE = 50;
                            let htmlText4 = "";
                            for (let i = 0; i < MAX_RECORD_SIZE; i++) {
                                htmlText4 += `
                                    <tr name="records${i}_flag">`;
                                for (let j = 0; j < 35; j++) {
                                    htmlText4 += `
                                        <td name="viewColumns${j}_flag">
                                            <div name="records${i}_field${j}">
                                            </div>
                                        </td>`;
                                }
                                htmlText4 += `
                                        <td>
                                        </td>
                                    </tr>`;
                            }
                            document.write(htmlText4);
                        </script>
                    </tbody>
                </table>
            </div>
            <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
                <div class="offcanvas-header">
                    <h5 class="offcanvas-title" id="offcanvasExampleLabel">
                        もっと列を表示する
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                    <div>
                        表示したい列名を入力してください。
                    </div>
                    <br>
                    <input class="form-check-input" type="checkbox" name="isToParent" style="display: none;">
                    <ul class="list-group">
                        <input name="newColumnPath0_flag" class="form-check-input flag" type="checkbox">
                        <li class="list-group-item">
                            <input name="newColumnPath0_columnName" type="text" readonly class="form-control-plaintext">
                        </li>
                        <!--  -->
                        <input name="newColumnPath1_flag" class="form-check-input flag" type="checkbox">
                        <li class="list-group-item">
                            <input name="newColumnPath1_columnName" type="text" readonly class="form-control-plaintext">
                        </li>
                        <!--  -->
                        <input name="newColumnPath2_flag" class="form-check-input flag" type="checkbox">
                        <li class="list-group-item">
                            <input name="newColumnPath2_columnName" type="text" readonly class="form-control-plaintext">
                        </li>
                        <!--  -->
                        <input name="newColumnPath3_flag" class="form-check-input flag" type="checkbox">
                        <li class="list-group-item">
                            <input name="newColumnPath3_columnName" type="text" readonly class="form-control-plaintext">
                        </li>
                        <!--  -->
                        <input name="newColumnPath4_flag" class="form-check-input flag" type="checkbox">
                        <li class="list-group-item">
                            <input name="newColumnPath4_columnName" type="text" readonly class="form-control-plaintext">
                        </li>
                        <!--  -->
                        <input name="newColumnPath5_flag" class="form-check-input flag" type="checkbox">
                        <li class="list-group-item">
                            <input name="newColumnPath5_columnName" type="text" readonly class="form-control-plaintext">
                        </li>
                        <!--  -->
                        <input name="newColumnPath6_flag" class="form-check-input flag" type="checkbox">
                        <li class="list-group-item">
                            <input name="newColumnPath6_columnName" type="text" readonly class="form-control-plaintext">
                        </li>
                        <!--  -->
                        <input name="newColumnPath7_flag" class="form-check-input flag" type="checkbox">
                        <li class="list-group-item">
                            <input name="newColumnPath7_columnName" type="text" readonly class="form-control-plaintext">
                        </li>
                    </ul>
                    <div class="input-group" style="margin-top: 5px; margin-bottom: 20px;">
                        <input onclick="myFetch('./auto_correct_column_path/form')" oninput="myFetch('./auto_correct_column_path/form')" type="text" class="form-control" name="newColumnPathInput">
                        <button onclick="myFetch('./add_column_path/form')" type="button" class="btn btn-primary">
                            追加
                        </button>
                    </div>
                    <button onclick="myFetch('./create_view_column/form')" type="button" class="btn btn-primary">
                        OK
                    </button>
                </div>
            </div>
        </form>
    </body>

</html>
