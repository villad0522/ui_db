[{"functionId":"test","functionNameJP":"テストコード","functionNameEN":"test","beforeCode":"","innerCode":"\n  await startUp(\"http://localhost:3000/\", true);\n  //\n  const { tableId: tableId1 } = await createTable(\"学年\");\n  const { columnId: columnId1 } = await createColumn( tableId1, \"学年\", \"INTEGER\", null );\n  const { recordId: recordId } = await createRecord( tableId1, {\n    [columnId1]: 3,\n  });\n  //\n  const { tableId: tableId2 } = await createTable(\"名簿\");\n  const { columnId: columnId2  } = await createColumn( tableId2, \"学年\", \"POINTER\", tableId1 );\n  const { columnId: columnId3  } = await createColumn( tableId2, \"氏名\", \"TEXT\", null );\n  await createRecord( tableId2, {\n    [columnId2]: recordId,\n    [columnId3]: \"田中太郎\",\n  });\n  //\n  const { sql, parameters } = await generateSQL(\n    tableId2,\n    [\n      {\n        displayColumnId: \"d1\",\n        type: \"RAW\",\n        path: `main.${columnId2} > ${columnId1}`,\n        as: \"学年\",\n      },\n      {\n        displayColumnId: \"d2\",\n        type: \"RAW\",\n        path: `main.${columnId3}`,\n        as: \"氏名\",\n      },\n    ],\n    [],\n    []\n  );\n  const matrix = await runSqlReadOnly(sql,parameters);\n  if( matrix.length !== 1 ){\n    throw \"テスト結果が想定とは異なります。\";\n  }\n  if( matrix[0]['学年'] !== 3 ){\n    throw \"テスト結果が想定とは異なります。\";\n  }\n  if( matrix[0]['氏名'] !== \"田中太郎\" ){\n    throw \"テスト結果が想定とは異なります。\";\n  }\n  const { sql: sql2, parameters: parameters2 } = await generateSQL(\n    tableId1,\n    [\n      {\n        displayColumnId: \"d1\",\n        type: \"RAW\",\n        path: `main.${columnId1}`,\n        as: \"学年\",\n      },\n      {\n        displayColumnId: \"d2\",\n        type: \"COUNT\",\n        path: `${columnId2} > main`,\n        as: \"人数\",\n      },\n    ],\n    [],\n    []\n  );\n  const matrix2 = await runSqlReadOnly( sql2, parameters2 );\n  console.log(matrix2);\n  await close();\n","afterCode":"","parametersName":[],"parametersDataType":[],"returnValue":"void"},{"functionNameJP":"SQLクエリを生成","functionNameEN":"generateSQL","parametersName":["tableId","displayColumns","conditions","sortOrder"],"parametersDataType":["string",[{"displayColumnId":"string","type":"string","path":"string","as":"string"}],[{"displayColumnId":"string","type":"string","value":"number"}],[{"displayColumnId":"string","isAscending":"boolean"}]],"returnValue":{"sql":"string","parameters":"any"},"functionId":"01HM5XB7TG9BDSEM6QQKMQ07P7","beforeCode":"\n\n","innerCode":"\n  // displayColumns の例\n  //   [\n  //     {\n  //       displayColumnId: \"d28\",\n  //       type: \"RAW\",\n  //       path: \"main.c2 > c53 > c1\",\n  //       as: \"○○\",\n  //     },\n  //     {\n  //       displayColumnId: \"d66\",\n  //       type: \"COUNT\",           // 集合関数。RAW, SUM、MAX、MIN、AVG、COUNT のいずれか。関数を使用しない場合はRAWを代入する。\n  //       path: \"c89 > c67 > main\",\n  //       as: \"○○の件数\",\n  //     },\n  //     {\n  //       displayColumnId: \"d43\",\n  //       type: \"MAX\",\n  //       path: \"c45 > c56 > main\",\n  //       as: \"○○の最大値\",\n  //     }\n  //   ]\n  //\n  // conditions の例\n  //   [\n  //     {\n  //       displayColumnId: \"d66\",\n  //       type: \"=\",       // !=, =, >, <, <=, >= のいずれか\n  //       value: 0,\n  //     }\n  //   ]\n  //\n  // sortOrder の例\n  //   [\n  //     {\n  //       displayColumnId: \"d78\",\n  //       isAscending: true,\n  //     }\n  //   ]\n  for( const { path } of displayColumns ){\n    // パスの文法をチェックする\n    await checkPath( path );\n  }\n  //\n  // テーブルを結合するために、外部キーの一覧を作成する（重複しないように）\n  const joinIdMap = await getJoinIdMap( displayColumns );\n  //\n  // 結合しているテーブルが重複しているか（ true:重複あり、false:重複無し ）\n  const isDuplication = await checkTableDuplication( tableId, joinIdMap );\n  //\n  const selectData = await getSelectData( displayColumns, joinIdMap );\n  const joinData = await getJoinData( joinIdMap );\n  const whereData = await getWhereData( displayColumns, conditions, joinIdMap );\n  const orderData = await getOrderData( displayColumns, sortOrder, joinIdMap );\n  //\n  if( isDuplication === true ){\n    // 重複しているテーブルを結合する場合、「テーブル名 AS 別名」と記入する必要がある。\n    return await generateSQLwithDuplication( tableId, selectData, joinData, whereData, orderData );\n  }\n  else{\n    // テーブルが重複していない場合\n    return await generateSQLwithoutDuplication( tableId, selectData, joinData, whereData, orderData );\n  }\n","afterCode":"\n\n\n"}]